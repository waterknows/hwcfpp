RIO DE JANEIRO —  Paulo Roberto Costa was living an oilman’s dream.He had a house in a luxurious gated community here. He bought a yacht and drove an armored Range Rover. He had more than $25 million stashed in bank accounts in Switzerland and the Cayman Islands.But that dream evaporated recently when the police arrested Mr. Costa and charged him with orchestrating a bribery scheme on an epic scale at Petrobras, Brazil’s national oil company, and funneling the proceeds to the governing Workers Party and its allies while enriching himself.The case has presented a major challenge to President Dilma Rousseff, who is in a bitter re-election fight against Aécio Neves, a centrist who has been gaining momentum as the vote next Sunday approaches.With the two candidates battling each other for the lead in opinion polls, Mr. Neves is seizing on the oil scandal to excoriate Ms. Rousseff and her administration, thrusting Mr. Costa, a 60-year-old engineer, into the national spotlight.Faced with the likelihood of a lengthy prison term, Mr. Costa, formerly one of Petrobras’s most powerful executives, accepted a plea deal from prosecutors. In return, he is testifying in detail that he turned the refining division of Petrobras, Brazil’s largest company, into a slush fund for Ms. Rousseff’s Workers Party and its coalition in Brasília.“The accusations suggest corrosive conclusions about Brazilian democracy,” said Matthew M. Taylor, a scholar at American University in Washington who specializes in Brazil’s legal system. “If proven true, then even flagship state companies are seen as fair targets to finance politics, and legislative coalitions continue to be held together by the glue of corruption.”Mr. Costa’s testimony, which has been made public by the judge investigating his case, is upending an already tumultuous presidential race, subjecting Ms. Rousseff to questions about whether she knew of corrupt practices at Petrobras or was negligent in her oversight of the oil company.At the same time, the scandal has highlighted the competing ideological visions of how Petrobras, which has made some of the largest oil discoveries in the world this century, should be managed. Since becoming president, Ms. Rousseff has asserted greater control over the energy giant, in line with her view that huge state-controlled companies should be the pillars of Brazil’s economic development.Mr. Neves, leader of the opposition Social Democrats, contends that the oil scandal is evidence that the management of Petrobras has grown too politicized and has become a tool for maintaining the Workers Party’s hold on power. Mr. Costa has testified that he started inflating budgets for new projects after he was promoted to oversee refining operations nearly a decade ago, accepting bribes equivalent to 3 percent of the value of the deals from the Brazilian construction companies that obtained the contracts.He testified that a portion of the money was then handed to João Vaccari Neto, the treasurer of the Workers Party. Mr. Costa said that other top political allies of Ms. Rousseff, including the leaders of both houses of Congress, Henrique Eduardo Alves and Renan Calheiros, also benefited from the kickbacks, according to a report by Veja, a Brazilian magazine.In another twist to the oil scandal and its influence on the presidential race, Mr. Costa said he bribed a major figure in Mr. Neves’s Social Democracy Party in 2009 to shelve a previous inquiry into irregularities at Petrobras.Investigators have corroborated Mr. Costa’s claims through an associate, Alberto Youssef, a black-market money dealer who testified that he helped launder funds in the scheme. Mr. Youssef, who has also accepted a plea deal, testified that more than a dozen of Brazil’s largest construction companies had paid hefty bribes to obtain lucrative Petrobras contracts.If their testimony is proven true, the oil scandal would dwarf previous corruption cases in Brazil, including a vote-buying scheme that resulted in the imprisonment of senior figures from the Workers Party in 2013. Their convictions and punishment were viewed as a precedent-setting shift in a political culture in which impunity has long prevailed.However, the scheme described by Mr. Costa is dashing hopes about a new era in Brazilian politics.“Scandals like the one at Petrobras topple presidents in countries with political consciousness,” said Ruth de Aquino, a columnist at the magazine Época. “In Japan, some politicians and executives commit suicide when they’re caught in theft of such magnitude. Here in Brazil, this doesn’t even peeve our leaders.”As part of his plea deal, Mr. Costa, who was first arrested in March as part of a money laundering investigation by the federal police, has already agreed to surrender the $25 million fortune he hid in offshore accounts, his yacht and his luxury car, in addition to paying a fine of more than $2 million. In exchange, he has been allowed to live under house arrest in Rio de Janeiro while wearing an ankle monitor.The political figures and corporations whom Mr. Costa and Mr. Youssef named as participants in the scheme have denied the accusations by the two men, portending a protracted legal battle. A spokeswoman for Petrobras declined to comment on the scandal.Nonetheless, the scandal has hurt the campaign of Ms. Rousseff, who has overseen Petrobras for more than a decade. As a cabinet minister and protégé of Brazil’s former president Luiz Inácio Lula da Silva, she was chairwoman of the board at Petrobras during the period when Mr. Costa said he assembled the bribery scheme within the company. She no longer sits on the board at Petrobras, but chooses its top executives.After her election in 2010, Ms. Rousseff kept Mr. Costa in his job until 2012, when he resigned to start a consulting venture.She has railed against the public disclosures of his testimony, calling them the equivalent of a “coup” aimed at thwarting her re-election bid. The judge in the case, Sergio Moro, has responded by saying that the law requires that evidence in the case be made public.But Ms. Rousseff has also effectively acknowledged the prevalence of corruption inside the executive suites of Petrobras, while denying that she had known about the kickbacks when they were taking place.“If anything happened, and everything indicates that it did, I can guarantee that all of the bleeding that eventually may have existed has been stanched,” Ms. Rousseff told the newspaper O Estado de S. Paulo in an interview.Ms. Rousseff has also pointed to a string of corruption scandals within Mr. Neves’s political party, which held power in Brazil from 1995 to 2002.Analysts say that the oil giant and other state-owned companies remain vulnerable to kickback schemes for one overriding reason: Presidents in Brazil rule in coalitions at the mercy of Congress, which includes more than 20 parties of various ideological stripes.“It’s Corruption 101: You get control of a state enterprise and then channel resources from it to the parties in your coalition,” said Sérgio Lazzarini, an economist at Insper, a São Paulo business school, who has written widely on Brazil’s state capitalism. “The situation is endemic, unlikely to change regardless of which president is in power.”Mr. Costa acknowledged as much in his testimony, describing how he rose to a position of influence in Petrobras with the support of a small party in the Workers Party’s coalition. He compared the process to the delicate politics involved in choosing commanders in Brazil’s military.“No one rises to become a general in the armed forces without being recommended,” he said. “It is obvious that no party chooses someone based only on their technical capacity.”