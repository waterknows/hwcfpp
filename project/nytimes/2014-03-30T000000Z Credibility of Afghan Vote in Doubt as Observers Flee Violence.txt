KABUL, Afghanistan —  Usually, an Afghan election — a $100 million, Western-funded exercise — draws foreigners to Kabul like flies to honey, with incoming flights full of consultants, international monitors, diplomats and journalists.Not this time. Now, it is the flights out that are full, and the incoming planes are half empty. With the possible exception of journalists, foreigners have been leaving Afghanistan like never before during an election period after a series of attacks on foreign targets and the commission running the vote.An attack on the offices of the Independent Election Commission went on all Saturday afternoon, with staff members hiding in armored bunkers and safe rooms while five insurgents fired rockets and small arms at the commission’s compound, having sneaked into a building nearby disguised in burqas.There were no reported casualties among the election staff, but flights to Kabul were diverted because the airport was shut down for most of the afternoon, said the airport’s director, Mohammad Yaqoub Rasooli.Even before the attack on Saturday, many international election monitors had either drastically curtailed their activities or made plans to evacuate their foreign employees, potentially raising serious questions about the validity of the election.The National Democratic Institute, a mainstay of previous Afghan elections, closed its Kabul office and sent its international monitors home after one was killed in a recent attack on the Serena Hotel, where the monitors were staying, said Kathy Gest, the institute’s spokeswoman.The International Republican Institute, which has helped monitor previous Afghan elections, has not been involved in this one.Ahmad Nader Nadery, chairman of the Free and Fair Election Foundation of Afghanistan, said that another major monitor, Democracy International, had decided to cease its activities altogether. But a Democracy International official said the group had merely reduced its presence because of security concerns.“The report that we are pulling out our staff and are not observing the election is inaccurate,” said the official, Jed Ober, director of programs. “We currently have a core team of six experts managing a team of 12 long-term observers.”Mr. Nadery said: “Leaving the country at this critical moment causes two problems. A lot of the election bodies and monitors will be denied their expertise, and it will affect the credibility of the elections. With their not being on the ground, they cannot make observations or judgments about the credibility of the process.”Elections that are relatively free and fair have been a minimum requirement for international donors, and many countries have made it clear that without them, they will not continue sending aid to Afghanistan at current levels. The 2009 presidential vote was widely viewed as flawed, even with the presence of many international monitors.Since the current campaign began in January, insurgents have vowed to disrupt it. So far, they have not attacked any of the 11 presidential candidates, who are heavily guarded. Instead, they have carried out a series of attacks on foreigners, mostly considered soft targets, as well as two high-profile attacks on election-related facilities: the one Saturday on the election commission, and another on a commission branch office in Kabul on Tuesday, which killed five Afghans.The commission’s main compound “is in total lockdown, and we have moved our staff to bunkers and safe houses,” a spokesman, Noor Ahmad Noor, said on Saturday. “None of the insurgents have managed to breach our security and enter.” Early reports said that two police officers had been wounded and that the five attackers had been killed.United Nations officials said they planned to keep a full complement of election experts and technicians in Afghanistan, though many other United Nations operations here are “basically skeleton agencies now,” one official said.For weeks, the United Nations has been encouraging staff members to take early vacations or leaves during the election period. But that advice became more urgent after the wave of violence, which included the deaths of 21 people, including United Nations employees, in an attack on a restaurant; the assassination of a Swedish journalist; the Serena attack; and, most recently, an attack apparently aimed at Christian missionaries in Kabul.The United Nations officials who have stayed are under such severe security restrictions that it is unclear how meaningful their assistance will be.“They’re really not able to do their jobs,” said one United Nations official, who requested anonymity because he was not authorized to speak to reporters. Referring to the United Nations Development Program, he added: “Even the U.N.D.P. international staff who used to be at the I.E.C., they’ve been pulled out of that building more than a month ago. So they don’t have the same sort of daily face-to-face engagement in Kabul, because you just can’t get out.”The departure of foreigners is affecting not only election monitoring, but also other activities. The country’s only five-star hotel, the Serena, was booked solid before the attack but is now nearly half empty, a reservation clerk said. The American University of Afghanistan suspended classes during the campaign and encouraged faculty members to use the time to travel abroad, according to its president, C. Michael Smith, who said that advice had been influenced by “increased security concerns in the run-up to the elections.”But Mr. Smith said that worries about the violence had so far prompted only one foreign faculty member to quit, and that no students had pulled out. “It is a challenging environment, but we also have a very dedicated faculty,” he said.Over all, though, safety concerns are making people change plans. “Foreigners are really leaving the country recently,” said Zemarai Kamgar, the president of Kam Air, an Afghan airline. Lately, he said, it has been rare to see more than one or two passengers on domestic flights, which previously accounted for one-tenth of passengers.There have even been fewer journalists than usual covering the campaign and other events, and some freelance translators have complained about the scarcity of work.One political analyst, Mohammad Younas Fakoor, said he believed that the insurgents had decided to drive foreigners from Afghanistan to discredit the election process.“The presence of foreign observers plays an important part in avoiding election fraud,” Mr. Fakoor said. “When none are present, the candidates will obviously use their power to scheme and defraud, and try to steal more votes. Then they’ll accuse one another of fraud.”The United Nations official expressed a similar concern. “We could see a dirty election, or one that lacks credibility, or it’ll be both dirty and lack credibility,” he said. “I don’t know how it can be otherwise.”