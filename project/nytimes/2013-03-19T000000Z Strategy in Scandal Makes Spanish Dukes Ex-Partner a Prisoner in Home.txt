BARCELONA, Spain — Diego Torres, a onetime marketing guru, built a $2 million dream home outside Barcelona, but it has become a luxury bunker since he challenged the Spanish royal family by revealing its private e-mails as part of his legal defense in a corruption investigation.Mr. Torres rarely ventures out now, fearing that he is being watched — the consequence of his brash strategy in an embezzlement scandal that has ensnared him and his former business partner, Iñaki Urdangarin, the duke of Palma and the son-in-law of King Juan Carlos.Mr. Torres’s lawyer has alerted the authorities that his office has been broken into three times. Other people connected to the case complain, privately for fear of reprisals, that they have received visits from men who they believe are associated with Spain’s secret services, the CNI.Mr. Torres’s dread is real enough that just weeks ago, a prosecutor opened an investigation to determine whether there was an intimidation campaign against him, adding a new element of spy craft to a corruption investigation that has riveted Spain. But the royal palace and Spanish security officials insist that they are not behind any surveillance, with one royal aide saying that they would never indulge in “kindergarten” antics.“What possibility does a knight have without a sword in the face of a machine with unlimited resources that is on the counterattack?” asked Mr. Torres’s lawyer, Manuel González Peeters. The only weapon, he said, is “the truth.”Mr. Torres, 47, and the duke, 45 — a former Olympic handball athlete married to Princess Cristina since 1997 — are accused of exploiting blue-blood connections to reap more than $7.8 million in regional government contracts by vastly inflating their bills through a nonprofit sports foundation, Instituto Nóos, and then diverting money to offshore companies.To defend himself, Mr. Torres salvaged a computer hard drive from the foundation that contained more than 200 e-mails from the duke. Some of them are notes copied to palace advisers and the king. So far, most are banal, including many that involve the duke’s search for a new job and efforts to seek sponsors for sports events, like a plea from the duke to the king to ask the head of LVMH, the French luxury goods giant, to donate about $261,000 to pay for a sports meeting organized by his foundation.But Mr. Torres is using the e-mails to attack the duke, who has testified to an investigating judge that the royal family had nothing at all to do with his foundation. Mr. Torres contends that the palace and its advisers monitored Mr. Urdangarin and the foundation’s dealings closely and offered advice on everything, including car rentals and the purchase of an office printer.The king has not been accused of any wrongdoing and is constitutionally immune from prosecution. But the stakes remain high because Princess Cristina was one of five officers in Nóos, but is the only one who has not testified despite Mr. Torres’s accusation that she was active in running the institute’s affairs.Mr. Torres’s defiant stance — in a nation that has long revered the royal family because of the monarch’s efforts to safeguard democracy — has come at a steep price. In 2011 he was dismissed from a university teaching post at an elite Barcelona business school after he was first implicated in the investigation.“He lost all his jobs immediately,” Mr. González Peeters said. “The royal palace thought that converting my client into an outcast was the solution. With no money there was no good lawyer. But they don’t know me.”New questions have emerged about the CNI’s involvement on the fringes of the case. Félix Sanz Roldán, the director of the Spanish secret services who is close to the king, faces questioning by lawmakers on Tuesday.He is likely to be asked why some 30,000 e-mails about Instituto Nóos turned up in the possession of an Argentine hacker, Matías Bevilacqua Trobado, who has done work for the CNI. Mr. Bevilacqua told the authorities he had the e-mails because he was hired by the duke’s lawyer, Manuel Pascual Vives. Mr. Pascual Vives said he had used Mr. Bevilacqua to sort e-mails already submitted as part of the case, unaware of his CNI history.The case has drawn interest because for decades, the royal family has been a stable pillar that united Spain. But lately the scandal has emboldened some politicians, including the leader of the Catalan Socialist party, to call for the abdication of the 75-year-old king. Mr. Torres has himself been accused of royal blackmail. But he testified that the duke’s lawyer offered him a deal to take the blame for the embezzlement scandal in return for money and a job in South America.He refused, telling a judge: “No way, no matter how desperate this is. I am not going to say something that isn’t the truth.”