
SOWETO, South Africa — For a day, the world came to Nelson Mandela’s adopted hometown. There were celebrities: Bono, Naomi Campbell, Charlize Theron. There were kings-in-waiting: Crown Prince Haakon of Norway and Crown Prince Felipe of Spain. There were more presidents and prime ministers than at just about any other setting outside a United Nations General Assembly.        
It was a singular gathering to celebrate a life virtually unmatched in modern times, and the assemblage of allies and adversaries reflected Mr. Mandela’s enduring legacy of forgiveness and reconciliation, as well the messy and sometimes clashing global allegiances of his party, the African National Congress.        
President Obama gave a eulogy that stirred the crowd, only to be followed later by President Raúl Castro of Cuba. The two even shared an unexpected handshake. Old friends met happily in the V.I.P. area, while old enemies, like former Prime Minister Tony Blair of Britain and President Robert Mugabe of Zimbabwe, avoided each other.        
“It took a man like Madiba to free not just the prisoner, but the jailer as well; to show that you must trust others so that they may trust you; to teach that reconciliation is not a matter of ignoring a cruel past, but a means of confronting it with inclusion and generosity and truth,” Mr. Obama said in his remarks, referring to Mr. Mandela by his clan name. “He changed laws, but he also changed hearts.”        
Sheets of driving rain swept across this former segregated township — an urban sprawl within sight of the glittery high rises of downtown Johannesburg — keeping many mourners away from the vast soccer stadium where Mr. Mandela made his last public appearance, during the World Cup in 2010. Still, tens of thousands of other South Africans, swathed in their national colors, came out to celebrate Mr. Mandela, who died on Thursday at the age of 95, some stomping their feet as protesters did during the movement that led to his release from prison in 1990 after 27 years of incarceration.        
“Even heaven is crying,” one woman in the crowd declared as the deluge continued. “We have lost an angel.”        
The day began with a joyful noise.        
Nothando Dube, 31, left her home in Soweto at dawn, joining a throng to sing old songs of the struggle against apartheid, waiting for the memorial to the man who brought democracy to South Africa and became its first black president. It was a moment for a country that at times still seems deeply divided by race, class, religion and tribe to join together once again as the Rainbow Nation of Mr. Mandela’s dreams.        
“It feels different when you sing it now as a free young person,” said Ms. Dube, wearing an A.N.C. beret. “You try to reach that feeling, that emotion they were feeling when they sang that song in prison.”        
But a few hours later, her mood had darkened. As jeers cascaded from the crowd aimed at South Africa’s current president, Jacob Zuma, Ms. Dube was one of many rolling their arms in the gesture known the world over as a call to substitute a failing player in a soccer match. It was an unmistakable message to Mr. Zuma, who faces corruption charges and deep worries about his governing of the country.        
“You don’t want to be airing your laundry in front of everybody, but people wanted to send a message,” she said. “The man on the street feels there’s a lot that should have been done by now to fix the country.”        
Like many around the world, the United Nations secretary general, Ban Ki-moon, praised Mr. Mandela’s ability to look beyond past wrongs, bridge divisions and build a new nation, inspiring his own country and many others far beyond its borders.        
“He showed the awesome power of forgiveness — and of connecting people with each other and with the true meaning of peace,” Mr. Ban said in his remarks. “That was his unique gift, and that was the lesson he shared with all humankind. He has done it again. Look around this stadium and this stage. We see leaders representing many points of view, and people from all walks of life. All here, all united.”        
But what had been planned as a moment to reunite a nation struggling with a slumping economy, widening inequality, rampant corruption and deep political divisions ultimately showcased the broad discontent with South African politics today. Many attending the service booed and hooted at Mr. Zuma, who has for many come to symbolize all the lost promise of South Africa’s peaceful transition from racist white rule to nonracial democracy.        
“I don’t own a house even though I am always struggling,” said George Tshotlego Mikobeni, 27 and unemployed, as he watched Mr. Zuma on stage at the memorial.        
“He is not like Madiba,” Mr. Mikobeni said. “He only cares about himself. This man spent all our money on his house, so many millions,” he continued, referring to $27 million on so-called security upgrades to Mr. Zuma’s home, which were paid for with government money but included things that had nothing to do with security, according to a preliminary investigation.        