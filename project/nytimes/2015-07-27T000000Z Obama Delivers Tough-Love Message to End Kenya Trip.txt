NAIROBI, Kenya — At one point during his weekend in Kenya, President Obama acknowledged the delicate nature of deciding which of his vast array of half cousins and stepaunts should be invited to dinner.“The people of Kenya,” he said wryly, “will be familiar with the need to manage family politics sometimes.”Over the course of two days here, Mr. Obama tried to manage the broader family politics of his father’s land, a country that considers him one of its own, even as it has played a singular role in his own life and career. Bathed in adulation, he nonetheless delivered a tough-love message before leaving on Sunday, challenging Kenya to tackle corruption, sexism and division.For the first African-American president returning to his ancestral home, a moment unlike any before in the history of either country, the visit was powerful and yet, at times, strangely impersonal. At some moments, Mr. Obama seemed genuinely moved by the experience, and he reflected on the country’s impact on him. At other times, he talked dispassionately about policy issues, sounding much like he does in plenty of other countries.He made it clear that he resented the security bubble that prevented him from visiting his father’s village or even just strolling down the streets of the capital, Nairobi, as he did as a young man. Kenyans clearly craved his attention, desperate in many cases to see him, talk with him or touch him, but they were largely kept at a distance. In the end, he has experienced more frenzied receptions in other countries, such as Ghana, his first stop in Africa as president in 2009, when his motorcade was swarmed by thousands of people.Mr. Obama, who arrived Friday evening, saw the first large-scale crowds of this trip on Sunday morning when his helicopter touched down at Kenyatta University. Thousands of students and others lined the streets, waving, cheering, taking photographs and in some cases wearing T-shirts with messages welcoming him.When his motorcade left the campus to head down a highway past ramshackle communities far from the polished buildings of downtown, he passed thousands more waiting along the road, in their case mostly silent, as if holding vigil.At Safaricom Indoor Arena, where he delivered a speech to 4,500 people, the crowd chanted, “Obama! Obama! Obama!” and the public address system played a song with the refrain, “I’m coming home.”When he went to shake hands after the speech, the only time he did that with everyday Kenyans, the crowd surged forward, pushing barriers several feet closer to him.“Don’t push, don’t push,” Mr. Obama implored, before making a quick exit after just a few minutes on the rope line.He had more of a sustained conversation later in the day with a group of 75 selected representatives of nongovernmental organizations. But it was a heavily scripted event, in which predetermined Kenyans were given the floor and each delivered a speech on his or her area of interest. Mr. Obama’s responses were sober and typically professorial.“Part of the challenge that I’ve had during the course of my presidency is that given the demands of the job and the bubble, I can’t come here and just go upcountry and visit for a week and meet everybody,” he lamented earlier in the trip. “I’m more restricted, ironically, as president of the United States than I will be as a private citizen.”In a country fighting the Shabab, a Qaeda affiliate that has carried out repeated deadly attacks on Kenyan soil, security was a serious concern, enough so that Joseph P. Clancy, the director of the Secret Service, personally accompanied Mr. Obama and Kenyan authorities shut down vital roads. Seemingly much of Nairobi stayed away for the first day.Mr. Obama hoped to connect with Kenyans at the arena, where he was introduced by his half sister, Auma Obama, who runs a foundation here and hosted him for his first visit to the country nearly three decades ago. Noting a common Kenyan saying — “don’t get lost” — she said that he is not lost now, “nor was he lost when he first came to Kenya. I’ll tell you that because he was with me. He fit right in.”“He’s not just our familia,” she added. “He gets us. He gets us.”Mr. Obama tried to show that with a few words of Swahili.“Habari Zenu!” he called out to the crowd, meaning, “How are you?”He recalled that first trip as a young man and how he arrived at the airport, where an airline official helping him fill out a form recognized his last name and asked if he was related to his father.“That was the first time that my name meant something,” he said.Recounting stories he also told in his memoir, Mr. Obama noted that during that visit, Auma’s car broke down repeatedly.“We’d be on the highway, we’d have to call the juakali — he’d bring us tools,” he said, referring to a serviceman. “We’d be sitting there, waiting. And I slept on a cot in her apartment. Instead of eating at fancy banquets with the president, we were drinking tea and eating ugali and sukumawiki,” or maize flour and greens.In making his personal connection, Mr. Obama then used it to gently push for progress. He noted that his grandfather had served as a cook for the British Army when Kenya was a colony, and that his father had gone to America to seek an education.“In many ways, their lives offered snapshots of Kenya’s history, but they also told us something about future,” he said. “They show the enormous barriers to progress that so many Kenyans faced just one or two generations ago.”To continue that progress, he said, Kenya needs to confront “the dark corners” of its past and wage a sustained campaign against corruption, expand its democracy, overcome ethnic division, protect human rights and work to end discrimination against women and girls.“Kenya is at a crossroads,” he said, “a moment filled with peril but also enormous promise.”Even as he held forth, he delicately navigated the sensitivities of his Kenyan hosts. He made the point that for democracy to thrive, “there also has to be space for citizens to exercise their rights,” without suggesting that Kenya had been closing that space or naming the human rights groups that have been targeted. He did not note that the arena where he spoke is part of a sports complex used just last year to round up Somalis for summary arrest and deportation.Instead, he acknowledged the United States’ own struggles, citing the recent shootings of nine black churchgoers in Charleston, S.C., and the dispute over flying the Confederate battle flag.“What makes America exceptional is not the fact that we’re perfect,” he said. “It’s the fact that we struggle to improve. We’re self-critical.”Mr. Obama said Kenya’s future lay with itself. Repeating a message he espoused during his first presidential trip to Africa in 2009, he emphasized that “the future of Africa is up to Africans,” and that they should not look “to the outside for salvation.” But he vowed that the United States would help.“I’m here as a friend who wants Kenya to succeed,” he said.By Sunday afternoon, as Mr. Obama arrived at the airport to head to his next stop in Ethiopia, hundreds of people gathered to see him off, including several groups of dancers in colorful outfits, ululating and banging drums. As he headed from his helicopter to Air Force One, Mr. Obama paused as if tempted to go over and greet them, as he does with crowds at almost any airport in the United States and many overseas.But evidently he thought better of it. He waved and smiled at them instead and headed up the stairs of his plane to depart for the last time as president.