WASHINGTON — A bipartisan group of senators has largely agreed on a broad immigration bill that would require tough border measures to be in place before illegal immigrants could take the first steps to become American citizens, according to several people familiar with drafts of the legislation.But in a delicate compromise worked out over weeks of negotiations, the bill does not impose any specific measurements of border enforcement results that, if they were not met, would stop the immigrants from proceeding toward citizenship.Instead, the bill allows a period of 10 years for the Department of Homeland Security to make plans and use resources to fortify enforcement at the borders and elsewhere within the country before it sets several broader hurdles that could derail the immigrants’ progress toward citizenship if they are not achieved.During the first decade after passage, the bill sets ambitious goals for border authorities — including continuous surveillance of 100 percent of the United States border and 90 percent effectiveness of enforcement in several high-risk sectors — and for other workplace and visa enforcement measures. It provides at least $3 billion for Homeland Security officials to meet those goals during the first five years, with a possibility of additional financing.The bill includes provisions, or “triggers,” during that decade that allow Congress at different points to ensure the enforcement goals are being met.As the group of eight senators continued on Wednesday to iron out final details of the legislation, several tens of thousands of immigrants, Latinos, labor union members, gay rights and other advocates held a rally on the lawn below the steps of the Capitol. With many waving American flags, they called for Congress to move quickly and demanded a direct path to citizenship for all 11 million illegal immigrants.“Families cannot continue to be torn apart,” Gustavo Torres, executive director of CASA de Maryland, an immigrant advocacy group, told the crowd.“Anything less than citizenship undermines American democracy,” he insisted.Senator Robert Menendez of New Jersey, a Democrat who is one of the eight senators working to draft the legislation, told the crowd that the group was close to presenting a bill.“We have to get those who are in the shadows into the light to have an opportunity to earn their citizenship and be part of the dream,” said Mr. Menendez, who like many of the other speakers delivered his words in both English and Spanish.The senators’ compromise allows Republican lawmakers, including Senators John McCain of Arizona and Marco Rubio of Florida, to say that they achieved border enforcement advances in the bill as a condition before any illegal immigrants can apply for permanent-resident green cards, the first step toward citizenship.But it also allows Democrats to describe the border measures as goals that can be achieved with the resources provided, so they will not become roadblocks that could stop the immigrants from reaching the final stage of citizenship.President Obama, who has been largely silent during the negotiations, is strongly opposed to any hindrances on the immigrants’ path that could be the focus of political battles later on.As drafted, the legislation would provide as much as $3.5 billion for the Department of Homeland Security to set up a five-year border security plan. Officials must present the plan within six months, and no immigrants can gain any provisional legal status until the plan is in place. It would include a program to finish any border fencing that border agents deem necessary.The plan must also show how the authorities will move quickly to spread technology across the border to ensure that agents can have surveillance capability along its entire length. They will also have five years to reach 90 percent effectiveness in their operations, a measure based on calculations of what percentage of illegal crossers were caught or turned back without crossing.If, after five years, border officials have not reached the surveillance and enforcement goals, the bill establishes a border commission to advise the Department of Homeland Security on how to reach its goals, with additional financing of up to $2 billion.Homeland Security officials will also be required to expand a worker verification system, making it mandatory nationwide for all employers within five years. Within 10 years, they must also create an electronic exit system at all airports and seaports to help ensure that foreigners leave when their visas expire.Also, illegal immigrants who pass background checks and meet other requirements will have to wait in a provisional status for at least 10 years, before they could apply for green cards. Before those applications can begin, officials must show that the border security plan is operational, the fence is completed, and the worker verification and visa exits systems are operating.At the rally, the demonstrators filled the large lawns that sweep down from the Capitol, and overflowed into lawns on either side. Groups of demonstrators came mainly from Washington, Maryland and Virginia, while several hundred buses brought delegates from around the country. Rather than concentrate all their forces in one place, organizers also held more than 30 smaller events around the country on Wednesday, including marches, early morning candlelight vigils, and door knocking.In Orlando, Fla., farmworkers and immigrants held a picnic in front of the offices of Mr. Rubio. In Los Angeles and Fresno, Calif., advocates rallied outside the offices of Senator Dianne Feinstein, a Democrat who is leading negotiations over the agricultural provisions in the bill. Many events were organized by the Service Employees International Union and other unions, which have strongly supported the immigration effort.Many activists spent the morning on Capitol Hill lobbying lawmakers, including a contingent from Alabama who delivered 250 small red footballs to the office of Senator Jeff Sessions, a Republican from that state who is a staunch opponent of the proposed legislation. “Don’t drop the ball,” was the message they conveyed.At the rally, Representative Luis V. Gutierrez of Illinois, a Democrat who has been a tenacious proponent of the immigration overhaul, said, “You need to guarantee that you give me and my colleagues and the Congress of the United States no place to hide.“There are no acceptable excuses for failing to pass immigration reform this year,” Mr. Gutierrez said, “and no excuses will be accepted.”Many in the crowd said they were hoping that the coming debate in Congress would not divert or close their path to becoming Americans.“I believe this is a country of opportunity,” said Alonso Martinez, 30, an immigrant from Mexico who lives in Maryland, “and without citizenship we are not going to have the same opportunity as the other immigrants who came before us.”